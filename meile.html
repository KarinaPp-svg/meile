<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Love Capsule</title>
  <meta name="description" content="A tiny, single‚Äëfile web app full of cute surprises." />
  <style>
    :root{
      --bg: #0f1222;
      --card: #171a2b;
      --muted: #9aa0b4;
      --text: #e8ecff;
      --accent1: #ff71a7;
      --accent2: #8a7dff;
      --accent3: #59f3d5;
      --glow: 0 0 32px rgba(255,113,167,.35);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color:var(--text);
      background: radial-gradient(1200px 800px at 20% -10%, rgba(255,113,167,.2), transparent 60%),
                  radial-gradient(1000px 600px at 120% 20%, rgba(138,125,255,.18), transparent 60%),
                  linear-gradient(180deg, #0b0e1a, #0f1222);
      background-attachment: fixed;
    }
    a{color:var(--accent3);text-decoration:none}
    .wrap{max-width:1080px;margin:0 auto;padding:24px}

    header{
      position:relative;
      border:1px solid rgba(255,255,255,.08);
      border-radius:calc(var(--radius) + 8px);
      padding:24px 20px 28px;
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      backdrop-filter: blur(6px);
      overflow:hidden;
      box-shadow: var(--glow);
    }
    header h1{margin:0;font-size:clamp(28px, 4vw, 44px);letter-spacing:.2px}
    header p{margin:6px 0 0;color:var(--muted)}
    .heart-field{position:absolute;inset:0;pointer-events:none}

    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px;margin-top:20px}
    .card{
      grid-column: span 12;
      background:var(--card);
      border:1px solid rgba(255,255,255,.06);
      border-radius:var(--radius);
      padding:16px;
      box-shadow:0 12px 40px rgba(0,0,0,.25);
    }
    @media (min-width:700px){
      .span-4{grid-column: span 4}
      .span-6{grid-column: span 6}
      .span-8{grid-column: span 8}
    }

    h2{margin:.25rem 0 1rem;font-size:1.2rem;letter-spacing:.3px}
    .muted{color:var(--muted)}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    input, button, textarea, select{
      font:inherit;color:inherit
    }
    input[type="text"], input[type="date"], textarea, select{
      background:#0f1120;border:1px solid rgba(255,255,255,.08);
      border-radius:12px;padding:10px 12px;outline:none;flex:1;min-width:120px
    }
    textarea{min-height:80px;resize:vertical}
    button{
      background:linear-gradient(90deg, var(--accent1), var(--accent2));
      border:none;border-radius:12px;padding:10px 14px;cursor:pointer;
      box-shadow:0 8px 24px rgba(255,113,167,.25);
    }
    button.secondary{background:#0f1120;border:1px solid rgba(255,255,255,.1);box-shadow:none}
    .pill{display:inline-flex;align-items:center;gap:8px;background:#0f1120;border:1px solid rgba(255,255,255,.08);padding:8px 10px;border-radius:999px}
    .coupon{display:flex;align-items:center;justify-content:space-between;gap:10px;background: #11142a;border:1px dashed rgba(255,255,255,.18);padding:12px 14px;border-radius:16px}
    .coupon.redeemed{opacity:.5;text-decoration:line-through}
    .gallery{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:10px}
    .gallery img{width:100%;height:120px;object-fit:cover;border-radius:12px;border:1px solid rgba(255,255,255,.08)}
    .note{background:#11142a;border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px}
    .note small{color:var(--muted)}
    .quiz .q{background:#11142a;border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px;margin-bottom:10px}
    .badge{font-size:.8rem;padding:4px 8px;border-radius:999px;background:rgba(255,113,167,.18);border:1px solid rgba(255,113,167,.45)}
    .footer{opacity:.75;font-size:.9rem;margin:20px 0}
    .hidden{display:none}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1 id="title">Labas, <span id="herNameLabel">love</span> ‚ù§Ô∏è</h1>
      <p class="muted">A tiny bundle of surprises from <span id="myNameLabel">me</span>.</p>
      <canvas id="hearts" class="heart-field"></canvas>
    </header>

    <div class="grid">
      <!-- Personalize -->
      <section class="card span-6" aria-labelledby="personalize">
        <h2 id="personalize">Personalize</h2>
        <div class="row">
          <input id="herName" type="text" placeholder="Her name (e.g., Sofija)" />
          <input id="myName" type="text" placeholder="Your name" />
          <button id="saveNames">Save</button>
        </div>
        <p class="muted" style="margin-top:8px">Tip: this app saves everything on your device only (localStorage).</p>
      </section>

      <!-- Countdown -->
      <section class="card span-6" aria-labelledby="countdown">
        <h2 id="countdown">Countdown to our next date</h2>
        <div class="row">
          <input id="dateInput" type="date" />
          <button id="saveDate">Set date</button>
          <span class="pill"><strong id="countdownOut">‚Äî</strong></span>
        </div>
      </section>

      <!-- Reasons -->
      <section class="card span-8" aria-labelledby="reasons">
        <h2 id="reasons">Reasons I adore you</h2>
        <div class="row" style="margin-bottom:8px">
          <input id="reasonInput" type="text" placeholder="Add a reason (hit Enter)" />
          <button id="addReason">Add</button>
          <button id="randomReason" class="secondary">Surprise me ‚ú®</button>
        </div>
        <div id="reasonList" class="row" style="gap:8px"></div>
      </section>

      <!-- Notes -->
      <section class="card span-4" aria-labelledby="notes">
        <h2 id="notes">A little note</h2>
        <textarea id="noteText" placeholder="Write her a tiny letter‚Ä¶"></textarea>
        <div class="row" style="margin-top:8px">
          <button id="saveNote">Save note</button>
          <span class="muted" id="noteSaved"></span>
        </div>
      </section>

      <!-- Gallery -->
      <section class="card span-8" aria-labelledby="gallery">
        <h2 id="gallery">Our memories</h2>
        <div class="row" style="align-items:center">
          <input id="imgPicker" type="file" accept="image/*" multiple />
          <button id="clearGallery" class="secondary">Clear</button>
        </div>
        <div id="galleryGrid" class="gallery" style="margin-top:10px"></div>
      </section>

      <!-- Coupons -->
      <section class="card span-4" aria-labelledby="coupons">
        <h2 id="coupons">Love coupons</h2>
        <div class="row" style="margin-bottom:8px">
          <input id="couponInput" type="text" placeholder="Add a coupon (e.g., Massage night)" />
          <button id="addCoupon">Add</button>
        </div>
        <div id="couponList" class="column" style="display:flex;flex-direction:column;gap:8px"></div>
      </section>

      <!-- Quiz -->
      <section class="card span-6" aria-labelledby="quiz">
        <h2 id="quiz">Us quiz üíò</h2>
        <div id="quizBox" class="quiz"></div>
        <button id="checkQuiz" style="margin-top:8px">Check answers</button>
        <p id="quizResult" class="muted"></p>
      </section>

      

  <script>
    // ===== Utilities & Storage =====
    const $ = (s) => document.querySelector(s);
    const $$ = (s) => Array.from(document.querySelectorAll(s));
    const store = {
      get: (k, d) => {
        try { return JSON.parse(localStorage.getItem(k)) ?? d; } catch { return d }
      },
      set: (k, v) => localStorage.setItem(k, JSON.stringify(v))
    };

    // ===== Hearts background =====
    (function hearts(){
      const c = document.getElementById('hearts');
      const ctx = c.getContext('2d');
      let W, H; const hearts = [];
      function resize(){ W = c.width = c.offsetWidth; H = c.height = c.offsetHeight }
      window.addEventListener('resize', resize); resize();
      function spawn(){
        const h = { x: Math.random()*W, y: H + 20, s: 8 + Math.random()*14, a: .6 + Math.random()*.4, vx: (Math.random()-.5)*.4, vy: -(.4 + Math.random()*1.2) };
        hearts.push(h);
      }
      function draw(){
        ctx.clearRect(0,0,W,H);
        hearts.forEach(h=>{
          h.x += h.vx; h.y += h.vy; h.a -= .0025; h.s *= 0.9995;
          ctx.save(); ctx.globalAlpha = Math.max(h.a,0);
          ctx.translate(h.x,h.y); ctx.rotate(Math.sin(h.y*0.02)*0.2);
          ctx.fillStyle = '#ff71a7';
          ctx.beginPath();
          const s=h.s; ctx.moveTo(0,0);
          ctx.bezierCurveTo(-s,-s,-2*s,.4*s,0,1.7*s);
          ctx.bezierCurveTo(2*s,.4*s,s,-s,0,0);
          ctx.fill(); ctx.restore();
        });
        for(let i=hearts.length-1;i>=0;i--) if(hearts[i].a<=0 || hearts[i].y<-40) hearts.splice(i,1);
        if(Math.random()<.25) spawn();
        requestAnimationFrame(draw);
      }
      draw();
    })();

    // ===== Personalize =====
    const herName = $('#herName');
    const myName = $('#myName');
    const herLabel = $('#herNameLabel');
    const myLabel = $('#myNameLabel');
    $('#saveNames').onclick = ()=>{
      store.set('names', { her: herName.value.trim()||'love', me: myName.value.trim()||'me' });
      loadNames(); celebrate();
    }
    function loadNames(){
      const n = store.get('names', {her:'love', me:'me'});
      herName.value = n.her; myName.value = n.me; herLabel.textContent = n.her; myLabel.textContent = n.me;
      document.title = `For ${n.her} ‚Äî Love Capsule`;
    }

    // ===== Countdown =====
    const dateInput = $('#dateInput'); const out = $('#countdownOut');
    $('#saveDate').onclick = ()=>{ if(dateInput.value){ store.set('date', dateInput.value); updateCountdown(); celebrate(); }}
    function updateCountdown(){
      const d = store.get('date', null); if(!d){ out.textContent = '‚Äî'; return }
      dateInput.value = d; const target = new Date(d + 'T00:00:00');
      function tick(){
        const now = new Date(); const diff = target - now;
        if(diff<=0){ out.textContent = 'It\'s today!'; return }
        const days = Math.floor(diff/86400000);
        const hrs = Math.floor((diff%86400000)/3600000);
        const mins = Math.floor((diff%3600000)/60000);
        out.textContent = `${days}d ${hrs}h ${mins}m`;
        requestAnimationFrame(()=>setTimeout(tick, 1000));
      }
      tick();
    }

    // ===== Reasons =====
    const reasons = new Set(store.get('reasons', [
      'Your laugh makes everything brighter',
      'You text me at the perfect moments',
      'You make ordinary days feel special',
      'You care so deeply about people',
      'Coffee tastes better with you',
      'You notice little things others miss'
    ]));
    const reasonList = $('#reasonList');
    function renderReasons(){
      reasonList.innerHTML = '';
      reasons.forEach((r)=>{
        const pill = document.createElement('span');
        pill.className = 'pill'; pill.title = 'Click to remove'; pill.style.cursor='pointer';
        pill.innerHTML = `üíó ${r}`;
        pill.onclick = ()=>{ reasons.delete(r); store.set('reasons', [...reasons]); renderReasons(); };
        reasonList.appendChild(pill);
      })
    }
    function addReason(text){ if(!text) return; reasons.add(text); store.set('reasons', [...reasons]); renderReasons(); $('#reasonInput').value=''; }
    $('#addReason').onclick = ()=> addReason($('#reasonInput').value.trim());
    $('#reasonInput').addEventListener('keydown', e=>{ if(e.key==='Enter') addReason(e.target.value.trim())});
    $('#randomReason').onclick = ()=>{
      if(!reasons.size) return; const arr = [...reasons];
      const pick = arr[Math.floor(Math.random()*arr.length)];
      toast(`Because ${pick.toLowerCase()} ü•π`); celebrate();
    }

    // ===== Notes =====
    const noteText = $('#noteText'); const noteSaved = $('#noteSaved');
    $('#saveNote').onclick = ()=>{ store.set('note', noteText.value); noteSaved.textContent='Saved!'; setTimeout(()=>noteSaved.textContent='', 1600); celebrate(40)}

    // ===== Gallery =====
    const imgPicker = $('#imgPicker'); const grid = $('#galleryGrid');
    imgPicker.onchange = async (e)=>{
      const files = Array.from(e.target.files).slice(0, 24);
      for(const f of files){
        const b64 = await toBase64(f); addImage(b64);
      }
      store.set('gallery', $$('#galleryGrid img').map(img=>img.src));
      imgPicker.value = '';
      celebrate();
    }
    function toBase64(file){ return new Promise((res,rej)=>{ const r=new FileReader(); r.onload=()=>res(r.result); r.onerror=rej; r.readAsDataURL(file) }) }
    function addImage(src){
      const img = new Image(); img.src = src; img.alt = 'Our memory'; img.loading='lazy';
      img.onclick = ()=>{ if(confirm('Remove this photo?')){ img.remove(); store.set('gallery', $$('#galleryGrid img').map(i=>i.src)) }}
      grid.prepend(img);
    }

    // ===== Coupons =====
    const couponInput = $('#couponInput'); const couponList = $('#couponList');
    $('#addCoupon').onclick = ()=>{ const t = couponInput.value.trim(); if(!t) return; coupons.push({t, used:false}); saveCoupons(); renderCoupons(); couponInput.value=''; celebrate(); }
    let coupons = store.get('coupons', [
      {t:'Breakfast in bed', used:false},
      {t:'One movie of your choice', used:false},
      {t:'Massage night', used:false}
    ]);
    function renderCoupons(){
      couponList.innerHTML='';
      coupons.forEach((c,i)=>{
        const row = document.createElement('div'); row.className='coupon'+(c.used?' redeemed':'');
        row.innerHTML = `<span>üéüÔ∏è ${c.t}</span>`;
        const actions = document.createElement('div'); actions.className='row';
        const use = btn(c.used? 'Used' : 'Redeem', ()=>{ coupons[i].used=!coupons[i].used; saveCoupons(); renderCoupons(); });
        const del = btn('Delete', ()=>{ coupons.splice(i,1); saveCoupons(); renderCoupons(); }, true);
        actions.append(use, del); row.appendChild(actions); couponList.appendChild(row);
      });
    }
    function btn(label, onClick, secondary=false){ const b=document.createElement('button'); b.textContent=label; if(secondary) b.className='secondary'; b.onclick=onClick; return b }
    function saveCoupons(){ store.set('coupons', coupons) }

    // ===== Quiz =====
const quiz = [
  { q: 'Where was our first date?', a: ['By the river','At the tiny pizza place','At the winter fair'], correct: 0 },
  { q: 'My go-to order is‚Ä¶', a: ['RedBull','Water','Tea'], correct: 2 },
  { q: 'What\'s my favorite time with you?', a: ['Lazy Sundays','Walks at night','All of the above'], correct: 2 }
];

    function renderQuiz(){
      const box = $('#quizBox'); box.innerHTML='';
      quiz.forEach((item, qi)=>{
        const q = document.createElement('div'); q.className='q';
        const title = document.createElement('div'); title.innerHTML = `<span class="badge">Q${qi+1}</span> ${item.q}`;
        q.appendChild(title);
        item.a.forEach((opt, oi)=>{
          const id = `q${qi}o${oi}`;
          const row = document.createElement('label'); row.style.display='flex'; row.style.alignItems='center'; row.style.gap='8px'; row.style.marginTop='6px';
          row.innerHTML = `<input type="radio" name="q${qi}" value="${oi}"> ${opt}`;
          q.appendChild(row);
        })
        box.appendChild(q);
      })
    }
    $('#checkQuiz').onclick = ()=>{
      let score=0; quiz.forEach((it,qi)=>{ const v = document.querySelector(`input[name="q${qi}"]:checked`); if(v && Number(v.value)===it.correct) score++; })
      const msg = score===quiz.length? 'Perfect! You know us by heart üíñ' : `We scored ${score}/${quiz.length}. Cute!`;
      $('#quizResult').textContent = msg; if(score===quiz.length) celebrate(120); else celebrate(40);
    }

    // ===== Toast & Confetti =====
    function toast(text){
      const t = document.createElement('div');
      t.textContent = text; t.style.position='fixed'; t.style.bottom='20px'; t.style.left='50%'; t.style.transform='translateX(-50%)';
      t.style.background = 'rgba(17,20,42,.9)'; t.style.border='1px solid rgba(255,255,255,.18)'; t.style.padding='10px 14px';
      t.style.borderRadius='12px'; t.style.boxShadow='0 8px 24px rgba(0,0,0,.4)'; t.style.zIndex=9999;
      document.body.appendChild(t); setTimeout(()=>{ t.style.transition='all .4s ease'; t.style.opacity='0'; t.style.transform='translateX(-50%) translateY(8px)'; }, 1600);
      setTimeout(()=>t.remove(), 2100);
    }
    function celebrate(amount=80){ // tiny confetti
      const particles = amount;
      const canvas = document.createElement('canvas');
      canvas.style.position='fixed'; canvas.style.inset='0'; canvas.style.pointerEvents='none'; canvas.style.zIndex=9998;
      document.body.appendChild(canvas);
      const ctx = canvas.getContext('2d');
      const W = canvas.width = innerWidth; const H = canvas.height = innerHeight;
      const P = Array.from({length:particles}, ()=>({
        x: Math.random()*W, y: -20 - Math.random()*H/2,
        r: 2 + Math.random()*4, v: 1 + Math.random()*2.5,
        w: Math.random()*2*Math.PI
      }));
      let t = 0;
      function tick(){
        ctx.clearRect(0,0,W,H); t+=0.02;
        P.forEach(p=>{
          p.y += p.v; p.x += Math.sin(p.w + t)*0.8; p.v *= 0.998;
          ctx.globalAlpha = 0.9; ctx.beginPath();
          ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
          const grad = ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r);
          grad.addColorStop(0,'#fff'); grad.addColorStop(1,['#ff71a7','#8a7dff','#59f3d5'][Math.floor(Math.random()*3)]);
          ctx.fillStyle = grad; ctx.fill();
        });
        if(P.every(p=>p.y>H+30)) return canvas.remove();
        requestAnimationFrame(tick);
      }
      tick();
    }

    // ===== Init (load saved state) =====
    function loadNote(){ noteText.value = store.get('note','') }
    function loadGallery(){ store.get('gallery', []).forEach(addImage) }
    function loadCoupons(){ coupons = store.get('coupons', coupons); renderCoupons() }
    function loadReasons(){ const saved = store.get('reasons', null); if(saved) { reasons.clear(); saved.forEach(r=>reasons.add(r)); } renderReasons() }

    loadNames(); updateCountdown(); loadReasons(); loadNote(); loadGallery(); loadCoupons(); renderQuiz();
  </script>
</body>
</html>
